(function(WorkerGlobalScope){var Pollen=function(){this[0]=WorkerGlobalScope;return this},each=Array.prototype.forEach,indexOf=Array.prototype.indexOf,push=Array.prototype.push,slice=Array.prototype.slice,hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,trim=String.prototype.trim;Pollen.prototype={identity:0,identify:{identify:function(){return Pollen.identity}},date:{now:function(e){return e?Math.round((new Date).getTime()/1e3):+(new Date)}},func:{noop:function(){},bind:function(e,t,n){if(e===null){return t}if(t&&e){return function(){return e.apply(t,n)}}}},evaluate:{isObj:function(e){if(!e){return false}if(e.constructor&&!hasOwn.call(e,"constructor")&&!hasOwn.call(e.constructor.prototype,"isPrototypeOf")){return false}var t;for(t in e){}return t===undefined||hasOwn.call(e,t)},isArr:function(e){return Array.isArray(e)},isRegExp:function(e){if(e){if((new RegExp(/([[\]\/\\])/g)).test(e)===false){return false}return(new RegExp(e)).test(null)||toStr.call(e)=="[object RegExp]"}return false},isFn:function(e){return e!==null&&toStr.call(e)==="[object Function]"&&typeof e=="function"},isStr:function(e){return e!==null&&typeof e=="string"&&isNaN(e)},isNum:function(e){return e!==null&&typeof e=="number"},isJson:function(e){if(e===null)return false;var t=Pollen.evaluate.isObj(e)?JSON.stringify(e):e;return(new RegExp('^("(\\\\.|[^"\\\\\\n\\r])*?"|[,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t])+?$')).test(t)},isDef:function(e){if(!e||e===null||typeof e==="undefined"||Pollen.evaluate.isEmpty(e)){return false}return true},isNull:function(e){return e===null},isEmpty:function(e){return e==null||e==""},eq:function(e,t){var n=0,r=t.length,i=false;for(;n<r;n++){if(e===t[n]){i=true;break}}return i}},string:{trim:function(e){if(e==null){return""}e=e+"";return e==""?"":e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},inStr:function(e,t){if(!e){return false}if(e.indexOf(t)>=0||(new RegExp(t,"ig")).test(e)){return true}return false},_regExpEscape:function(e){if((new RegExp(/([[\]\/\\])/g)).test(e)===false){return String(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}return e}},array:{each:function(e,t){var n=0,r=e.length;if(Pollen.evaluate.isArr(e)){for(;n<r;n++){t.call(e,n,e[n])}}if(Pollen.evaluate.isObj(e)){for(var i in e){if(e[i]){t.call(e[i],i,e[i],n++)}}}},toArray:function(e){if(!e){return[]}if(Pollen.evaluate.isArr(e)){return e}if(Pollen.evaluate.isStr(e)){return e.split("")}var t=e.length||0,n=[];while(t--){n[t]=e[t]}return n},isAtIndex:function(e,t,n){if(e[t]==n){return true}return false},inArray:function(e,t){var n,r=Array.isArray(e)?t:e,i=Array.isArray(e)?e:t;return i.indexOf(r)>-1},clone:function(e){if(Pollen.evaluate.isArr(e)){return[].concat(e)}var t=Pollen.evaluate.isArr(e)?[]:{};for(var n in obj){if(hasOwn.call(obj,n)){t[n]=this.clone(obj[n])}}return t},last:function(e){return e[e.length-1]},first:function(e){return e[0]},unique:function(e){var t=0,n=[],r=[];for(var i in e){if(!Pollen.array.inArray(r,JSON.stringify(e[i]))){n[n.length]=e[i];r[r.length]=JSON.stringify(e[i])}}return n},merge:function(e){var t=e,n=0;for(;n<arguments.length;n++){t=Pollen.evaluate.isArr(arguments[n])?t.concat(arguments[n]):Pollen.object.extend(t,arguments[n])}return Pollen.evaluate.isArr(t)?this.unique(t):t},combine:function(e,t){var n=0,r=e.length,i={};if(!e||!t||!Pollen.evaluate.isArr(e)||!Pollen.evaluate.isArr(t)){return false}if(r!=t.length){throw"Cannot combine arrays, key length does not match value length"}for(;n<r;n++){i[e[n]]=t[n]}return i},filter:function(e,t,n){var r=0,i=e.length,s=[];if(!Pollen.evaluate.isArr(e)){s={};for(var o in e){if(t(e[o],r)){s[o]=e[o]}}return s}for(;r<i;r++){if(t(e[r],r)){s[s.length]=e[r]}}return s},map:function(e,t){var n=[],r=0,i=e.length;for(;r<i;r++){var s=t(e[r],r);if(s!==null){n[n.length]=s}}return n.concat.apply([],n)},grep:function(e,t,n){var r=[],i;if(Pollen.evaluate.isFn(t)){return Pollen.array.filter(e,t)}i=!Pollen.evaluate.isRegExp(t)?Pollen.string._regExpEscape(t):t;Pollen.array.each(e,function(t,s){if(typeof s==="number"){s=s+""}if(s.match(i)){r[r.length]=n?n.call(e,s,t):s}});return r},size:function(e){if(Pollen.evaluate.isArr(e)||Pollen.evaluate.isStr(e)){return Pollen.array.toArray(e).length}if(Pollen.evaluate.isObj(e)){var t=0;for(var n in e){if(!Pollen.evaluate.isNull(e[n])){t++}}return t}return Pollen.array.toArray(e).length},pick:function(e,t){var n=[];Pollen.array.each(e,function(e,r){n[n.length]=r[t]});return n},sortBy:function(e,t,n){return Pollen.array.map(e,function(e,r){return{value:e,criteria:t.call(n,e,r)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;return n<r?-1:n>r?1:0}).pick("value")},compact:function(e){var t=[undefined,null,false],n=Pollen.evaluate.isArr(e)?[]:{},r=function(e){var t=e.length,i="";for(var s in e){i=e[s];if(Pollen.evaluate.isArr(i)){r(i)}else{if(!Pollen.evaluate.eq(i,[undefined,null,false])){if(Pollen.evaluate.isArr(n)){n[n.length]=i}else{n[i]=i}}}}return true};r(e);return n}},object:{keys:function(e){var t=[];for(var n in e){if(e[n]){t[t.length]=n}}return t},values:function(e){var t=[];for(var n in e){if(e[n]){t[t.length]=e[n]}}return t},extend:function(e,t){if(Pollen.evaluate.isNull(e)&&Pollen.evaluate.isDef(t)){return t}for(var n in t){if(hasOwn.call(t,n)){var r=t[n],i=e[n];if(!Pollen.evaluate.isNull(r)){e[n]=i&&typeof r=="object"&&typeof i=="object"?Pollen.array.merge(i,r):r}}}return e}},ajax:{_options:{url:"",data:"",dataType:"",success:Pollen.noop,type:"GET",async:true,xhr:function(){return new XMLHttpRequest}},get:function(e){e.type="GET";this._ajax(e)},post:function(e){e.type="POST";this._ajax(e)},_ajax:function(e){var t=Pollen.object.extend(this._options,e),n=t.dataType=="json"?true:false,r=t.type.toLowerCase(),i=t.xhr(),s=t.success;if(!Pollen.evaluate.isStr(t.data)){t.data=Pollen.data.param(t.data)}if(r=="get"&&t.data.length){t.url+=((new RegExp(/\?/)).test(t.url)?"&":"?")+t.data}if(i){Pollen.ajax._confXHR(i,t,n,s);i.open(t.type,t.url,t.async);if(Pollen.evaluate.isDef(Pollen.identity)){}if(r=="post"){i.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}i.send(r=="post"?t.data:null)}},_confXHR:function(e,t,n,r){function u(){if(r){r.call(e,i)}}var i,s;var o=e.onreadystatechange=function(){if(e.readyState==4){s=Pollen.evaluate.isJson(e.responseText)?JSON.parse(e.responseText):null;i=n?s:{text:e.responseText,xml:e.responseXML,json:s};u()}};return e}},data:{param:function(e){function n(e,n){n=Pollen.evaluate.isFn(n)?n():n;t[t.length]=encodeURIComponent(e)+"="+encodeURIComponent(n)}var t=[];Pollen.array.each(e,function(e,t){n(e,t)});if(arguments.length==2&&arguments[1]===true){n("WORKER_ID",Pollen.identity)}return t.join("&").replace(/%20/g,"+")},cache:{pollen:+(new Date)},storage:function(e,t){if(e&&t===undefined){return Pollen.data.cache[e]?Pollen.data.cache[e]:false}Pollen.data.cache[e]=t;return Pollen.data.cache[e]},query:function(){function slice(e,t,n,r){var i=e.length,s=[];n=n||i;t=t<0?Math.max(0,t+i):Math.min(i,t);n=n<0?Math.max(0,n+i):Math.min(i,n);for(var o=t;o<n;o+=r){s[s.length]=e[o]}return s}function expand(e,t){function r(e){if(t){if(t===true&&!(e instanceof Array)){n[n.length]=e}else if(e[t]){n[n.length]=e[t]}}for(var i in e){var s=e[i];if(!t){n[n.length]=s}else if(s&&typeof s=="object"){r(s)}}}var n=[];if(Pollen.evaluate.isArr(t)){if(t.length==1){return e[t[0]]}for(var i=0;i<t.length;i++){n[n.length]=e[t[i]]}}else{r(e)}return n}function distinctFilter(e,t){var n=[],r={},i=e.length,s=0;for(;s<i;++s){var o=e[s];if(t(o,s,e)){if(typeof o=="object"&&o){if(!o.__included){o.__included=true;n[n.length]=o}}else if(!r[o+typeof o]){r[o+typeof o]=true;n[n.length]=o}}}for(s=0,i=n.length;s<i;++s){if(n[s]){delete n[s].__included}}return n}return function(query,obj){function pcall(e){prefix=e+"("+prefix}function makeRegex(e,t,n,r,i){return strs[i].match(/[\*\?]/)||r=="~"?"/^"+strs[i].substring(1,strs[i].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,".$1")+(r=="~"?"$/i":"$/")+".test("+t+")":e}var depth=0,strs=[],prefix="",executor="";query=query.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(e){depth+=e=="["?1:e=="]"?-1:0;return e=="]"&&depth>0?"`]":e.charAt(0)=='"'||e.charAt(0)=="'"?"`"+(strs.push(e)-1):e}).replace(/([^<>=]=)([^=])/g,"$1=$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(e){return e.charAt(0)=="."?e:e=="@"?"$obj":(e.match(/:|^(\$|Math|true|false|null)$/)?"":"$obj.")+e}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(e,t,n){var r=e.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/);if(r){var i="";if(e.match(/^\./)){pcall("expand");i=",true)"}pcall(r[1].match(/\=/)?"Pollen.array.map":r[1].match(/\^/)?"distinctFilter":"Pollen.array.filter");return i+",function($obj){return "+r[2]+"})"}r=e.match(/^\[\s*([\/\\].*)\]/);if(r){return".concat().sort(function(a,b){"+r[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(e,t,n){return"var av= "+n.replace(/\$obj/,"a")+",bv= "+n.replace(/\$obj/,"b")+";if(av>bv||bv==null){return "+(t=="/"?1:-1)+";}\n"+"if(bv>av||av==null){return "+(t=="/"?-1:1)+";}\n"})+"})"}r=e.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/);if(r){pcall("slice");return","+(r[1]||0)+","+(r[2]||0)+","+(r[3]||1)+")"}if(e.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)){pcall("expand");return(e.charAt(1)=="."?",'"+n+"'":e.match(/,/)?","+e:"")+")"}return e}).replace(/(\$obj\s*(\.\s*[\w_$]+\s*)*)(==|~)\s*`([0-9]+)/g,makeRegex).replace(/`([0-9]+)\s*(==|~)\s*(\$obj(\s*\.\s*[\w_$]+)*)/g,function(e,t,n,r,i){return makeRegex(e,r,i,n,t)});query=prefix+(query.charAt(0)=="$"?"":"$")+query.replace(/`([0-9]+|\])/g,function(e,t){return t=="]"?"]":strs[t]});executor=eval("1&&function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj=$;return "+query+"}");for(var i=0;i<arguments.length-1;i++){arguments[i]=arguments[i+1]}return obj?executor.apply(this,arguments):executor}}()},worker:{send:function(e){var t=e,n;if(!Pollen.evaluate.isDef(e)){return}if(!Pollen.evaluate.isObj(e)){t={message:e}}if(e.SEND_TO){t.SEND_FROM=Pollen.identity}t.WORKER_ID=Pollen.identity;return postMessage(t)},reply:function(e){return Pollen.worker.send(e)},receive:function(e){return addEventListener("message",function(t){var n=t.data;if(Pollen.identity==""){Pollen.identity=n.WORKER_ID}return e.call(t,n)},false)}},json:{encode:JSON.parse,decode:JSON.stringify}};Pollen=new Pollen;p=$=new function WorkerOnMessage(){if(arguments.length){if(Pollen.evaluate.isFn(arguments[0])){return Pollen.worker.receive(arguments[0])}}return WorkerOnMessage};p.ajax=$.ajax=Pollen.ajax;"identify date string evaluate reflection array func object data json worker".split(" ").forEach(function(e){for(var t in Pollen[e]){p[t]=$[t]=Pollen[e][t]}})})(this)